<!DOCTYPE HTML>
<!--
    Spectral by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>Async multiplayer</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" />
	</noscript>
	<link rel="stylesheet" href="prism.css">
</head>

<body class="is-preload">

<!-- Page Wrapper -->
<div id="page-wrapper">

	<!-- Header -->
	<header id="header">
		<h1><a href="index.html">Home</a></h1>
		<nav id="nav">
			<ul>
				<li><a href="aboutme.html">About me</a></li>
			</ul>
		</nav>
	</header>

	<!-- Title + gameplay video -->
	<article id="main">
		<div class="header-container">
			<header
					style="background-image: url('images/BannerBackground.png'); background-size: cover; background-position: top; background-repeat: no-repeat; color: #ffffff; text-align: center; padding: 10px;">
				<div class="logo-container">
					<img src="images/Async_Multiplayer-banner.png" alt="Your Logo">
				</div>
			</header>
		</div>
		<section class="wrapper style5">
			<div class="inner">
				<!-- Description and tags -->
				<div class="row aln-center" style="padding: 0">
					<!-- Description -->
					<div class="col-9">
						<h3>About this project:</h3>
						<p>
							This is a small scale project where I learned how to use a database to make an asynchronous multiplayer game.
						</p>
						<p>
					</div>
					<!-- Tags -->
					<div class="col-3">
						<div class="tooltip-always-visible">
							<span class="tooltip-item-always-visible">Unity</span>
							<span class="tooltip-item-always-visible">C#</span>
							<span class="tooltip-item-always-visible">PHP</span>
							<span class="tooltip-item-always-visible">Solo project</span>
						</div>
					</div>
				</div>

				<!-- Video -->
				<h3 style="padding-top: 2em;">Gameplay video: </h3>
				<div class="iframe-container">
					<iframe src="https://www.youtube.com/embed/Af9KtxoN5hE?si=q5IJxFUJNR5RGGxr"
							title="YouTube video player" frameborder="0"
							allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
							allowfullscreen></iframe>
				</div>
			</div>
		</section>
	</article>

	<!-- My contribution -->
	<article id="My contribution">
		<section class="wrapper style5">
			<div class="inner">
				<h3>My contribution: </h3>
			</div>
			<div class="inner">
				<h4>Building</h4>
				<div class="video-explanation-container">
					<div class="video-container">
						<video autoplay loop muted playsinline style="width: 100%; border-radius: 15px">
							<source src="assets/video/Async_building.mp4" type="video/mp4">
						</video>
					</div>
					<div class="explanation-container">
						<p>
							Once the player tries to build something, the game sends a request to the server to check if the player has enough resources to build the object, and if the tile is unoccupied.
						</p>
					</div>
				</div>
				<hr>
						<h5 style="padding-bottom: 10px; margin: 0"><a href="https://gist.github.com/RijkMulder/2ef837d1e410627b97986484e815c449" target="_blank">View whole script.</a></h5>
				<pre style="padding: 0px; margin: 0"><code class="language-php" style="white-space: pre-wrap;user-select: text">
// try find tile in db
$tile = $request->tile;
$tolerance = 0.01;
$stmt = $connectionResult->prepare(
    "SELECT * FROM user_tiles WHERE user_id = :user_id 
    AND ABS(tile_pos_x - :posX) < :tolerance 
    AND ABS(tile_pos_y - :posY) < :tolerance"
);
$stmt->execute([
    ':user_id' => $userid, 
    ':posX' => $tile->posX, 
    ':posY' => $tile->posY,
    ':tolerance' => $tolerance
]);
$tileResult = $stmt->fetch(PDO::FETCH_ASSOC);

// tile doesnt exist
if ($tileResult == false) {
    // check if request info is empty
    if ($request->tile->tileType == null) {
        $response->status = "emptyTileData";
        $response->customMessage = "tile data sent was empty.";
        $response->userData = GetUserData($connectionResult, $userid);
        die(json_encode($response));
    }
    // check price
    if (CheckPrice($connectionResult, $userid, $tile) == true) {
        // update gold
        UpdateGold($connectionResult, $userid, $tile);

        // send succes response
        $response->userData = GetUserData($connectionResult, $userid);
        $response->status = "tileFree";
        $response->customMessage = "succesfully placed building";
        die(json_encode($response));
    }
    else {
        $response->status = "notEnoughGold";
        $response->customMessage = "user doesn't have enough gold to buy this building.";
        die(json_encode($response));
    }
}

else {
    // tile already exists
    include 'GetGold.php';
}
</code></pre>
			</div>
			<div class="inner">
				<h4>Enemy behaviour</h4>
				<div class="video-explanation-container">
					<div class="video-container">
						<video autoplay loop muted playsinline style="width: 100%; border-radius: 15px">
							<source src="assets/video/TileHopperEnemyBehaviour.mp4" type="video/mp4">
						</video>
					</div>
					<div class="explanation-container">
						<p>
							The enemy behaviour had the same problem as the map did, the damn hexagons, I had to figure out a way to make it select a new tile to move towards, but it would then obviously need to
							know what tiles were next to it, and because the map is made out of hexagons there were six of them.
						</p>
					</div>
				</div>
				<hr>
						<h5 style="padding-bottom: 10px; margin: 0"><a href="https://gist.github.com/RijkMulder/863d86ce848adc16ecbec91d2bef8551" target="_blank">View whole script.</a></h5>
				<pre style="padding: 0px; margin: 0"><code class="language-cs" style="white-space: pre-wrap;user-select: text">
 private Vector2 ChooseRandomTilePos()
 {
    // Set chooseNewPos bool to false.
    chooseNewPos = false;

    // Get the grid size from the level creator.
    Vector2 grdSize = lvlCreator.gridSize;

    // Define possible neighbor tile positions relative to the current tile.
    Vector2[] NeighbourTiles =
    {
       new Vector2(-1, 1),
       new Vector2(0, 1),
       new Vector2(-1, 0),
       new Vector2(1, 0),
       new Vector2(-1, -1),
       new Vector2(0, -1)
    };

    // Check if the current row is even or odd.
    bool isEvenRow = gridPos.y % 2 == 0;

    // Loop until a valid tile position is found.
    while (true)
    {
       // Choose a random neighboring tile.
       int randomTile = Random.Range(0, NeighbourTiles.Length);
       Vector2 neighbourPos = gridPos + NeighbourTiles[randomTile];

       // Check if the neighboring position is within bounds.
       if (neighbourPos.y != 0)
       {
          // Adjust x-coordinate for even rows if needed. (might be magic)
          if (isEvenRow && (randomTile == 0 || randomTile == 1 || randomTile == 4 || randomTile == 5))
          neighbourPos.x += 1;

          // Check if the neighboring position is within the grid boundaries.
          if (neighbourPos.x <= grdSize.x && neighbourPos.y <= grdSize.y && neighbourPos.x > 0)
          {
             // Get the tile object at the neighboring position.
             Tile tile = gridObj.FindTileInGrid(neighbourPos).GetComponent&lt;Tile&gt;();

             // Check if the tile is unoccupied and not a winning or selected tile.
             if (tile.tileState != TileState.Occupied && tile.tileState != TileState.Selected && tile.tileState != TileState.WinTile)
             {
                // Set the tile state to selected and return its position.
                Debug.Log(tile.tileState);
                tile.tileState = TileState.Selected;
                return tile.gridPos;
             }
          }
       }
    }
 }

</code>
</pre>
			</div>
		</section>
	</article>

	<!-- Footer -->
	<footer id="footer">
		<ul class="icons">
			<li><a href="https://github.com/RijkMulder" class="icon brands fa-github" target="_blank"><span class="label">Github</span></a></li>
			<li><a href="mailto:mulderrijk@gmail.com" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
			<li><a href="https://www.linkedin.com/in/rijk-mulder-7184a8305/" class="icon brands fa-linkedin" target="_blank"><span class="label">Linkedin</span></a></li>
		</ul>
		<ul class="copyright">
			<li>&copy; Rijk Mulder</li>
			<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
		</ul>
	</footer>

</div>

<!-- Scripts -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/jquery.scrollex.min.js"></script>
<script src="assets/js/jquery.scrolly.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>
<script src="prism.js"></script>
<script>
	document.addEventListener('DOMContentLoaded', (event) => {
		document.querySelectorAll('pre code').forEach((block) => {
			hljs.highlightBlock(block);
		});
	});
</script>

</body>

</html>